# 蓝莺 IM SDK 更新记录

蓝莺 IM，是由[美信拓扑](https://www.lanyingim.com/)团队研发的新一代即时通讯云服务，SDK 设计简单集成方便，服务采用云原生技术和多云架构，私有云也可按月付费。

### v2.9.9 20210811

1. 收取历史消息不需要额外通知；
2. Fix Bug: 获取 roster 失败引发 socket 初始化失败，将会导致 disConnect 时候异常；

### v2.9.8 20210801

1. Fix Bug: 好友信息更新时间应该使用 onRosterInfoUpdate；
2. Fix Bug: 自动登录未正确设置 isLogin，导致同一用户会出现两次登录；
3. Demo bug fix: 好友信息变化后不再触发花名册更新，后者将会在处理不存在用户时引发循环请求；
4. Demo: 显示花名册好友昵称；
5. Demo: 持久化存储 AppID，页面刷新后依然使用上次设置 AppID；

### v2.9.7 20210728

1. Fix Bug: 收到 userNotice 后退出并不再重连；
2. Demo：增加 userNotice 演示；
3. Demo bug fix: 退出登录另一账号后，会话页面消息显示错误判断是否为自己发送；

### v2.9.6 20210723

1. 优化登陆速度至 100ms 以内；
2. Demo：由于登陆速度过快，需要在初始化函数内立即注册监听，否则会丢失登陆成功通知；

### v2.9.5 20210303

1. 限制获取同一 ID 的好友信息频次，一秒内只能发起一次；
2. Fix bug: 群聊信息默认 status 不应为 UNREAD；

### v2.9.4 20210113

1. 支持从服务端获取消息已读未读状态；
2. 与 Uniapp 同步版本；
3. 支持发送定位消息，type: location；
4. Fix bug：偶现情况下 token 失效上报事件使用了 loginFailure 而不是 loginFail；
5. Demo：演示发送定位信息；
6. Demo: 调整未读数显示位置；
7. Demo fix bug: 单聊时不显示自己头像；
8. Demo fix bug：发送消息后显示已读；

### v2.9.3 20210111

1. 使用 prettier 格式化工程；
2. Demo bug fix：修改 AppID 后不初始化；

### v2.9.2 20210110

1. 支持单独获取消息已读未读状态；
2. Fix bug：退出登录后遗留数据清理；
3. Demo: 退出后清理个人 Profile；
4. Demo: 重构历史消息合并逻辑；

### v2.9.1 20210107

1. 私有云文件发送 Bug；
2. Demo: 显示图片原图以及视频封面；

### v2.8.2 20201103

1. 增加 SDK 初始化状态判断方法 im.isReady，并增加示例等待 SDK 初始化成功；
2. 为会话 last message 增加 ext 字段；
3. 重构 ack 存储，修复事件 onUnreadChange；
4. Fix bug: 发送者不应该发送 READ_ACK；
5. 获取历史消息可指定条数：

### v2.8 20200924

1. 适配 v2 DNS 服务，支持国外加速节点；
2. 冻结用户和 LICENSE 相关错误不再触发重新登录；

### v2.7.2 20200915

1. 优化服务 DNS 刷新机制；
2. 增加自定义协议支持，ext 字段解析；
3. 删除会话前增加存在性检查；
4. Websocket 链接出错后回收关闭；
5. Demo：演示自定义协议；
6. Demo: 添加自动登录逻辑；

### v2.7.1 20200903

1. 优化重连策略，在网络不稳定情况下冷却重连超时；
2. 弱网情况下调整最大连接超时为 90s，延迟登陆时间 10s；

### v2.7 20200825 七夕快乐

1. 支持删除远程会话；
2. 删除会话操作从 im 挪到 im.sysManage；
3. Demo：删除好友/群也会触发删除会话；
4. 性能优化：历史聊天记录不再触发 ReadAck；
5. 支持内嵌在原生 App 中使用厂商推送，可绑定/解绑 DeviceToken;

### v2.5 20200809

！此次更新涉及数据格式变化，升级注意清空本地缓存

1. 支持删除本地会话；
2. 重构 message 存储，增加分区，极大地提高了性能；

### v2.4 20200730

1. 统一事件通知，增加 flooNotice，dnsError 移到 flooError；
2. 增加用户被封禁登陆失败通知 USER_BANNED；
3. 同步发布 Uniapp 版本；
4. 适配修改，多端版本统一；

### v2.3.5 20200629

1. 演示用户自定义协议，即消息 ext 字段使用；

### v2.3.4 20200522

1. 修改说明文档，解释 sourceType: 'unambiguous' 的重要性；

### v2.3.3 20200430

1. fix bug：视频图片显示路径问题；

### v2.3 20200428

1. 提高文件访问地址 URL 的安全性；
2. 同步小程序解决音频播放问题；

### v2.2 20200425

1. 单独显示系统通知；
2. 演示群组设置；
3. 优化：把 refreshServers 从 io 挪到 dnsManange 里；

### v2.1 20200306

1. 发布使用 2.0 库；
2. 重构存储，合并小程序版本 SDK；

### v1.1 20200225

1. 为聊天室消息增加优先级；

### v1.0 20200223 正式发布

1. 支持单聊、群聊；
2. 支持文本、语音（微信小程序）、图片和视频消息；
3. 支持个人信息、头像；
4. 支持自定义协议；
5. 对接蓝莺 IM 云服务，设置 appid；
